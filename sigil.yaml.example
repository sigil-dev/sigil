# Sigil configuration
# https://github.com/sigil-dev/sigil

# Authentication
# When tokens are configured, the following API behaviors change:
# - GET /workspaces filters to only workspaces where the user is a member
# - GET /plugins, GET /plugins/{id}, POST /plugins/{id}/reload require admin:plugins permission
# - POST /chat and GET /chat/stream verify the user is a workspace member
#
# When no tokens are configured, all endpoints are accessible (development mode).
# See docs/decisions/decision-log.md (D061) for details.
#
# auth:
#   tokens:
#     user_token_1:
#       user_id: "user1"
#       permissions: ["admin:plugins", "workspace:personal"]
#     user_token_2:
#       user_id: "user2"
#       permissions: ["workspace:personal"]

# Networking
networking:
  mode: local                       # local | tailscale
  listen: "127.0.0.1:18789"
  enable_hsts: false                # Enable HTTP Strict Transport Security
  rate_limit_rps: 0                 # Requests per second per IP (0 = disabled)
  rate_limit_burst: 0               # Burst size for rate limiting
  # trusted_proxies:                # CIDR ranges of trusted reverse proxies
  #   - "10.0.0.0/8"               # Required when mode=tailscale (behind proxy)
  #   - "172.16.0.0/12"            # Only X-Forwarded-For from these IPs is trusted
  # tailscale:
  #   hostname: "my-agent"
  #   auth_key: "${TS_AUTHKEY}"
  #   node_auth:
  #     required_tag: "tag:agent-node"

# LLM Providers
providers:
  anthropic:
    api_key: "${ANTHROPIC_API_KEY}"
  # openai:
  #   api_key: "${OPENAI_API_KEY}"
  # ollama:
  #   endpoint: "http://localhost:11434"

# Model configuration
models:
  default: "anthropic/claude-sonnet-4-5"
  failover:
    - "anthropic/claude-sonnet-4-5"
  budgets:
    per_session_tokens: 100000
    per_day_usd: 50.00

# Sessions
sessions:
  memory:
    active_window: 20
    compaction:
      strategy: summarize
      summary_model: "anthropic/claude-haiku-4-5"
      batch_size: 50

# Workspaces
workspaces:
  personal:
    description: "Default personal workspace"
    members: []
    tools:
      allow: ["*"]
      # deny: ["tool.dangerous_exec"]   # deny patterns evaluated first
    skills: []
  # team:
  #   description: "Shared team workspace"
  #   members: ["alice", "bob"]
  #   bindings:
  #     - channel: "slack"
  #       channel_id: "C12345"
  #   tools:
  #     allow: ["tool.*"]
  #     deny: ["tool.shell_exec"]
  #   skills: ["summarize"]
